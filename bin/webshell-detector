#!/usr/bin/env php
<?php

if (is_file(__DIR__ . "/../vendor/autoload.php")) {
    ## To run the binary after you clone the repository
    require_once __DIR__ . "/../vendor/autoload.php";

} elseif (is_file(__DIR__ . "/../../vendor/autoload.php")) {
    ## To run the binary installed with composer
    require_once __DIR__ . "/../../vendor/autoload.php";
}

use RUCD\WebshellDetector\Detector;

if ($argc != 2) {
    echo "Usage: " . $argv[0] . " <filename>\n";
    exit();
}

$filename = $argv[1];

$detector = new Detector();
echo $detector->analyzeFile($filename) . "\n";